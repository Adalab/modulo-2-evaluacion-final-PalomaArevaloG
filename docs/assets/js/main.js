"use strict";const input=document.querySelector(".js_input"),btnSearch=document.querySelector(".js_btn-search");let favorites=document.querySelector(".js_fav"),list=document.querySelector(".js_list");const btnReset=document.querySelector(".js_btn-reset"),numero=document.querySelector(".js-results");let arrayShows=[],arrayFavs=[];function handleSearch(s){s.preventDefault();let e=input.value;fetch("//api.tvmaze.com/search/shows?q="+e).then(s=>s.json()).then(s=>{arrayShows=s,paintShows(),paintFavs()})}function paintShows(){let s="",e="";for(const a of arrayShows){e=isFavorite(a)?"favorite":"",null===a.show.image?(s+=` <li id = "${a.show.id}"\n            class = "list-show js_list-show ${e}"> `,s+=' <div class = "result js_result "> ',s+=` <h2 class = "js_showName showName"> ${a.show.name} </h2>`,s+='<img class="js-image img" src="https://via.placeholder.com/210x295/ffffff/666666/?text=TV"/>',s+="</div></li>"):(s+=`<li id="${a.show.id}" class="list-show js_list-show ${e}">`,s+='<div class="result js_result ">',s+=`<h2 class="js_showName showName">${a.show.name}</h2>`,s+=`<img class="js-image img" src="${a.show.image.medium}"/>`,s+="</div></li>")}numero.innerHTML=arrayShows.length,list.innerHTML=s,listenShows()}function handleFavs(s){const e=parseInt(s.currentTarget.id),a=arrayShows.find(s=>s.show.id===e),t=arrayFavs.findIndex(s=>s.show.id===e);-1===t?arrayFavs.push(a):arrayFavs.splice(t,1),paintShows(),paintFavs()}function listenShows(){const s=document.querySelectorAll(".js_list-show");for(const e of s)e.addEventListener("click",handleFavs)}function isFavorite(s){return void 0!==arrayFavs.find(e=>e.show.id===s.show.id)}function paintFavs(){let s="";for(const e of arrayFavs)null===e.show.image?(s+=`<li id="${e.show.id}" class="list-show js_list-show-favorite">`,s+='<div class="result js_result ">',s+=`<h2 class="js_showName showName">${e.show.name}</h2>`,s+=`<img class="js-image img-fav" src="https://via.placeholder.com/210x295/ffffff/666666/?text=TV"/><i id="${e.show.id}" class="fas fa-times js_icon"></i>`,s+="</div></li>"):(s+=`<li id="${e.show.id}" class="list-show js_list-show-favorite">`,s+='<div class="result js_result ">',s+=`<h2 class="js_showName showName">${e.show.name}</h2>`,s+=`<img class="js-image img-fav" src="${e.show.image.medium}"/><i id="${e.show.id}" class="fas fa-times js_icon"></i>`,s+="</div></li>");favorites.innerHTML=s,setInLocalStorage(),clickedIcon()}function setInLocalStorage(){const s=JSON.stringify(arrayFavs);localStorage.setItem("arrayFavs",s)}function getLocalStorage(){const s=localStorage.getItem("arrayFavs"),e=JSON.parse(s);arrayFavs=e,paintFavs()}function clickedIcon(){const s=document.querySelectorAll(".js_icon");for(const e of s)e.addEventListener("click",removeFav)}function removeFav(s){const e=parseInt(s.currentTarget.id),a=arrayFavs.findIndex(s=>s.show.id===e);arrayFavs.splice(a,1),setInLocalStorage(),paintFavs(),paintShows()}function removeAllFavs(){arrayFavs=[],setInLocalStorage(),paintFavs(),paintShows()}btnReset.addEventListener("click",removeAllFavs),btnSearch.addEventListener("click",handleSearch),getLocalStorage();