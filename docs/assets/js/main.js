"use strict";const input=document.querySelector(".js_input"),btnSearch=document.querySelector(".js_btn-search");let favorites=document.querySelector(".js_fav"),list=document.querySelector(".js_list");const btnReset=document.querySelector(".js_btn-reset");let arrayShows=[],arrayFavs=[];function handleSearch(s){s.preventDefault();let a=input.value;fetch("//api.tvmaze.com/search/shows?q="+a).then(s=>s.json()).then(s=>{arrayShows=s,paintShows(),paintFavs(),setInLocalStorage()})}function paintShows(){let s="",a="";for(const e of arrayShows){isFavorite(e)?(a="favorite",favorites.innerHTML+=s):a="",null===e.show.image?(s+=`<li id="${e.show.id}" class="list-show js_list-show ${a}">`,s+='<div class="result js_result ">',s+=`<h2 class="js_showName showName">${e.show.name}</h2>`,s+='<img class="js-image img" src="https://via.placeholder.com/210x295/ffffff/666666/?text=TV"/>',s+="</div></li>"):(s+=`<li id="${e.show.id}" class="list-show js_list-show ${a}">`,s+='<div class="result js_result ">',s+=`<h2 class="js_showName showName">${e.show.name}</h2>`,s+=`<img class="js-image img" src="${e.show.image.medium}"/>`,s+="</div></li>")}list.innerHTML=s,listenShows()}function handleFavs(s){const a=parseInt(s.currentTarget.id),e=arrayShows.find(s=>s.show.id===a),t=arrayFavs.findIndex(s=>s.show.id===a);-1===t?arrayFavs.push(e):arrayFavs.splice(t,1),paintShows(),paintFavs()}function listenShows(){const s=document.querySelectorAll(".js_fav-show");for(const a of s)a.addEventListener("click",handleFavs)}function isFavorite(s){return void 0!==arrayFavs.find(a=>a.show.id===s.show.id)}function paintFavs(){let s="";for(const a of arrayFavs)null===a.show.image?(s+=`<li id="${a.show.id}" class="list-show js_fav-show">`,s+='<div class="result js_result ">',s+=`<h2 class="js_showName showName">${a.show.name}</h2>`,s+='<img class="js-image img-fav" src="https://via.placeholder.com/210x295/ffffff/666666/?text=TV"/><i class="fas fa-times js_icon"></i>',s+="</div></li>"):(s+=`<li id="${a.show.id}" class="list-show js_fav-show">`,s+='<div class="result js_result ">',s+=`<h2 class="js_showName showName">${a.show.name}</h2>`,s+=`<img class="js-image img-fav" src="${a.show.image.medium}"/><i class="fas fa-times js_icon"></i>`,s+="</div></li>");favorites.innerHTML=s,setInLocalStorage(),clickedIcon()}function setInLocalStorage(){const s=JSON.stringify(arrayFavs);localStorage.setItem("arrayFavs",s)}function getLocalStorage(){const s=localStorage.getItem("arrayFavs");if(null===s)handleSearch();else{const a=JSON.parse(s);arrayFavs=a,paintFavs()}}function clickedIcon(){const s=document.querySelectorAll(".js_icon");for(const a of s)a.addEventListener("click",removeFav)}function removeFav(s){const a=parseInt(s.currentTarget.id),e=arrayFavs.findIndex(s=>s.id===a);arrayFavs.splice(e,1),setInLocalStorage(),paintFavs(),paintShows()}function removeAllFavs(){arrayFavs=[],setInLocalStorage(),paintFavs(),paintShows()}btnReset.addEventListener("click",removeAllFavs),btnSearch.addEventListener("click",handleSearch),getLocalStorage();